{% load staticfiles %}
<html>
<style>
*, ::after, ::before {
    box-sizing: border-box;
}
html {
    height: 100%;
}
body {
    text-align: center !important;

    display:flex;
    padding-top: 40px;
    padding-bottom: 40px;
    background-size: cover;
}
.flatbox {
    width: 100%;
    max-width: 400px;
    background-color: white;
    padding-left: 20px;
    padding-right: 20px;
    padding-top: 1%;
    padding-bottom: 1%;
    margin: auto;
    box-shadow: 4px 4px 6px #aaaaaa;
}
.gslogen {
    font-family: Consolas;
    font-size: 2rem;
    font-weight: bold;
}
.lbot {
    background-color: #eeeeee;
    height: 50px;
    line-height: 50px;
}
</style>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Register</title>
<link rel="stylesheet" href="https://cdn.bootcss.com/bootstrap/4.1.0/css/bootstrap.min.css">
<link rel="stylesheet" href="https://cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.css">

<!-- jQuery文件。务必在bootstrap.min.js 之前引入 -->
<script src="https://cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script>

<!-- popper.min.js 用于弹窗、提示、下拉菜单 -->
<script src="https://cdn.bootcss.com/popper.js/1.12.5/umd/popper.min.js"></script>

<!-- 最新的 Bootstrap4 核心 JavaScript 文件 -->
<script src="https://cdn.bootcss.com/bootstrap/4.1.0/js/bootstrap.min.js"></script>

<script src="{% static 'bootstrap-datetimepicker/css/bootstrap-datetimepicker.min.css' %}"></script>
<script src="{% static 'bootstrap-datetimepicker/js/bootstrap-datetimepicker.min.js' %}"></script>
<script src="{% static 'bootstrap-datetimepicker/js/locales/bootstrap-datetimepicker.zh-CN.js' %}"></script>


</head>
<body background="{% static 'images/gxm.jpg' %}">
<!--header-->
{#<div class="modal" id="infoModal" tabindex="-1" role="dialog" aria-labelledby="infoModalTitle" aria-hidden="true">#}
{#    <div class="modal-dialog modal-dialog-centered" role="document">#}
{#        <div class="modal-content">#}
{#            <div class="modal-header">#}
{#                <h5 class="modal-title" id="infoModalTitle"></h5>#}
{#                <button type="button" class="close" data-dismiss="modal" aria-label="Close">#}
{#                    <span aria-hidden="true">&times;</span>#}
{#                </button>#}
{#            </div>#}
{#            <div class="modal-body">#}
{#                <p id="information"></p>#}
{#            </div>#}
{#            <div class="modal-footer">#}
{#                <button type="button" class="btn btn-primary" data-dismiss="modal">关闭</button>#}
{#            </div>#}
{#        </div>#}
{#    </div>#}
{#</div>#}



<!--//header-->
<form class="flatbox">
    <div class="gslogen mb-4"><em>CMS</em></div>
    <h1 class="h3 mb-3 font-weight-normal">机构注册</h1>
    <div class="row form-group">
        <div class="col col-md-3"><label class=" form-control-label">机构名</label></div>
        <div class="col-12 col-md-9">
            <input type="text" class="form-control" required="required" name="name" id="name"/>
        </div>
    </div>
    <div class="row form-group">
        <div class="col col-md-3"><label class=" form-control-label">工商号</label></div>
        <div class="col-12 col-md-9">
            <input type="text" class="form-control" required="required" name="corporate_id" id="corporate_id"/>
        </div>
    </div>
    <div class="row form-group">
        <div class="col col-md-3"><label class=" form-control-label">地点</label></div>
        <div class="col-12 col-md-9">
            <input type="text" class="form-control" required="required" name="place" id="place"/>
        </div>
    </div>
    <div class="row form-group">
        <div class="col col-md-3"><label class=" form-control-label">法人</label></div>
        <div class="col-12 col-md-9">
            <input type="text" class="form-control" required="required" name="legal_person" id="legal_person"/>
        </div>
    </div>
    <div class="row form-group">
        <div class="col col-md-3"><label class="form-control-label">时间</label></div>

        <div class="input-group date form_datetime col-md-9">
            <input type="text" value="2018-06-30" readonly="readonly" class="form-control" id="establish_date">
        </div>
    </div>

    <div class="row form-group">
        <div class="col col-md-3"><label class="form-control-label">类型</label></div>
        <div class="col-12 col-md-9">
            <select name="type" id="type" class="form-control">
                <option value="1">公司</option>
                <option value="2">政府</option>
                <option value="3">学校</option>
                <option value="4">其他</option>
            </select>
        </div>
    </div>
    <div class="row form-group">
        <div class="col col-md-3"><label class=" form-control-label">用户名</label></div>
        <div class="col-12 col-md-9">
            <input type="text" class="form-control" required="required" name="username" id="username"/>
        </div>
    </div>
    <div class="row form-group">
        <div class="col col-md-3"><label class=" form-control-label">密码</label></div>
        <div class="col-12 col-md-9">
            <input type="password" class="form-control" required="required" name="password" id="password"/>
        </div>
    </div>
    <div class="row form-group">
        <div class="col col-md-3"><label class=" form-control-label">重复密码</label></div>
        <div class="col-12 col-md-9">
            <input type="password" class="form-control" required="required" name="password2" id="password2"/>
        </div>
    </div>
    <div class="row form-group">
        <div class="col col-md-3"><label class=" form-control-label">邮箱</label></div>
        <div class="col-12 col-md-9">
            <input type="email" class="form-control" required="required" name="email" id="email"/>
        </div>
    </div>
    <div class="row form-group">
        <div class="col col-md-3"><label class=" form-control-label">手机</label></div>
        <div class="col-12 col-md-9">
            <input type="text" class="form-control" required="required" name="tel" id="tel"/>
        </div>
    </div>
    <button class="btn btn-lg btn-primary btn-block mt-4 mb-2" type="button" onclick="up()">注册</button>
</form>
<script type="text/javascript">
     $('#establish_date').datetimepicker({
    format: 'yyyy-mm-dd'
});
     function up(){
         var data = {
            "name" : document.getElementById("name").value,
            "corporate_id" : document.getElementById("corporate_id").value,
            "place" : document.getElementById("place").value,
            "legal_person" : document.getElementById("legal_person").value,
            "establish_date" : document.getElementById("establish_date").value,
            "type" : document.getElementById("type").value,
            "username" : document.getElementById("username").value,
            "password" : document.getElementById("password").value,
            "password2" : document.getElementById("password2").value,
            "email" : document.getElementById("email").value,
            "tel" : document.getElementById("tel").value
        }
        $.ajax({
            url : '/institution/institution/register/',
            type : 'POST',
            data : data,
            dataType : 'json',
            success : function(response) {
                if(response['errorInfo'] != null){
                    alert(response['errorInfo']);
                    document.getElementById("name").value = null
                    document.getElementById("corporate_id").value = null
                    document.getElementById("place").value = null
                    document.getElementById("legal_person").value = null
                    document.getElementById("username").value = null
                    document.getElementById("password").value = null
                    document.getElementById("password2").value = null
                    document.getElementById("email").value = null
                    document.getElementById("tel").value = null
                }else{
                    window.location.href='/login/';
                }
            }
        });

    }
</script>









</body>

</html>