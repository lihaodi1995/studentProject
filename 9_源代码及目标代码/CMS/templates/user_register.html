{% load staticfiles %}
<html>
<style>
    *, ::after, ::before {
        box-sizing: border-box;
    }
    html {
        height: 100%;
    }
    body {
        text-align: center !important;
        height: 100%;
        display:flex;
        padding-top: 40px;
        padding-bottom: 40px;
        background-size: cover;
    }
    .flatbox {
        width: 100%;
        max-width: 400px;
        background-color: white;
        padding-left: 20px;
        padding-right: 20px;
        padding-top: 40px;
        padding-bottom: 40px;
        margin: auto;
        box-shadow: 4px 4px 6px #aaaaaa;
    }
    .gslogen {
        font-family: Consolas;
        font-size: 2rem;
        font-weight: bold;
    }
    .lbot {
        background-color: #eeeeee;
        height: 50px;
        line-height: 50px;
    }
</style>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>Register</title>
    <link rel="stylesheet" href="https://cdn.bootcss.com/bootstrap/4.1.0/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.css">

    <!-- jQuery文件。务必在bootstrap.min.js 之前引入 -->
    <script src="https://cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script>

    <!-- popper.min.js 用于弹窗、提示、下拉菜单 -->
    <script src="https://cdn.bootcss.com/popper.js/1.12.5/umd/popper.min.js"></script>

    <!-- 最新的 Bootstrap4 核心 JavaScript 文件 -->
    <script src="https://cdn.bootcss.com/bootstrap/4.1.0/js/bootstrap.min.js"></script>
</head>
<body background="{% static 'images/gxm.jpg' %}">




<!--//header-->
<form class="flatbox">
    <div class="gslogen mb-4"><em>CMS</em></div>
    <h1 class="h3 mb-3 font-weight-normal">用户注册</h1>
    <label class="sr-only" for="username" >用户名</label>
    <input class="form-control"  id="username" autofocus="autofocus" required="required" type="text" placeholder="用户名"  name="username" onfocus="this.value = '';" />
    <p></p>
    <label class="sr-only" for="password">密码</label>
    <input class="form-control" name="password" id="password" required="required" type="password" placeholder="密码" onfocus="this.value = '';" />
    <p></p>
    <input class="form-control" name="password2" id="password2" required="required" type="password" placeholder="重复密码" onfocus="this.value = '';" onkeyup="confirmpw()" />
    <p></p>
    <label class="sr-only" for="email">电子邮箱</label>
    <input class="form-control" name="email" id="email" required="required" type="email" placeholder="电子邮箱" onfocus="this.value='';" />
    <p></p>
    <label class="sr-only" for="tel">手机号</label>
    <input class="form-control" name="tel" id="tel" required="required" type="text" placeholder="手机号" onfocus="this.value='';"/>
    <button class="btn btn-lg btn-primary btn-block mt-4 mb-2" type="button" onclick="up()" >注册</button>
</form>

<script type="text/javascript">
     function up(){
        var data = {
            'username' : document.getElementById("username").value,
            'password' : document.getElementById("password").value,
            'password2' : document.getElementById("password2").value,
            'email' : document.getElementById("email").value,
            'tel' : document.getElementById("tel").value,
            }
        $.ajax({
            type : 'POST',
            url : "/user/register/",
            data : data,
            dataType : 'json',
            success : function(response) {
                if(response['errorInfo'] != null){
                    alert(response['errorInfo']);
                    document.getElementById("username").value = null
                    document.getElementById("password").value = null
                    document.getElementById("password2").value = null
                    document.getElementById("email").value = null
                    document.getElementById("tel").value = null
                }else{
                    window.location.href='/login/';
                }
            }
        });

    }
</script>



</body>

</html>